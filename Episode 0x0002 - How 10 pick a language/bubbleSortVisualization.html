<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<title>Sorting Hat - Bubble Sort</title>

	<style>
		body {
			font-size: 40px;
			margin: 0 3rem;
		}

		ol {
			column-count: 3;
		}

		.hidden {
			display: none;
		}

		.big {
			font-size: 200px;
		}

		.huge {
			font-size: 400px;
		}

		.center {
			text-align: center;
		}

		.inverse {
			background-color: black;
			color: white;
		}
	</style>
</head>

<body>
	<div id="not-complete">
		<div>
			<ol id="languages"></ol>
		</div>

		<div>
			<button id="run" type="button">Run</button>
		</div>
	</div>

	<div id="complete" class="hidden center">
		<div class="big">You should use:</div>
		<div class="huge" id="selected-language"></div>
	</div>

	<script type="text/javascript">
		const delay = 10;
		const languages = [
			'Java',
			'C',
			'Python',
			'C++',
			'Erlang',
			'Julia',
			'C#',
			'JavaScript',
			'PHP',
			'Swift',
			'Ruby',
			'Pascal',
			'Objective-C',
			'Assembly',
			'Hack',
			'Go',
			'R',
			'MATLAB',
			'Haskell',
			'Elm',
			'Elixir',
			'Bash',
			'Clojure',
			'F#',
			'COBOL',
			'Fortran',
			'Ada',
			'D',
			'Visual Basic',
			'Perl',
			'SAS',
			'Groovy',
			'Dart',
			'Scratch',
			'Reason',
			'Scala',
			'Lisp',
			'Kotlin',
			'Rust',
			'Logo',
			'Lua',
			'TypeScript',
			'RPG',
			'ML',
			'PowerShell',
			'LabVIEW',
			'Scheme',
			'OpenEdge ABL',
			'LiveCode',
			'Prolog'
		];

		const swap = (index, elems) => {
			const tmp = elems[index];
			elems[index] = elems[index + 1];
			elems[index + 1] = tmp;
		};

		const update = elems => {
			const list = document.getElementById('languages');
			list.innerHTML = elems.map(elem => `<li>${elem}</li>`).join('');
		};

		const flash = () => {
			document.getElementById('complete').classList.toggle('inverse');
			setTimeout(flash, 1000);
		};

		const finish = elems => {
			document.getElementById('not-complete').classList.add('hidden');
			document.getElementById('selected-language').innerHTML = elems[0];
			document.getElementById('complete').classList.remove('hidden');

			flash();
			return elems;
		};

		const bubbleSort = (elems, index, needsAnotherCycle) => {
			setTimeout(() => {
				update(elems);

				index = index || 0;
				needsAnotherCycle = !!needsAnotherCycle;

				if (index === elems.length - 1) {
					return needsAnotherCycle
						? bubbleSort(elems, 0, false)
						: finish(elems);
				}

				if (elems[index] > elems[index + 1]) {
					swap(index, elems);
					return bubbleSort(elems, index + 1, true);
				}

				return bubbleSort(elems, index + 1, needsAnotherCycle);
			}, delay);
		};

		const run = () => bubbleSort(languages.slice(0));

		document.getElementById('run').onclick = run;
	</script>
</body>

</html>